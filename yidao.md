1. 项目概述

项目名称： 易经速学速测
项目目标： 开发一个快速（每局约 1 分钟）、有趣、单人玩法的 Mini App 小游戏。游戏通过小挑战帮助玩家学习易经基础知识（如卦象识别、爻变概念），并设有积分排名。
技术栈： Mini App (平台特定), Vite, React, TypeScript, Wagmi (用于链上交互/用户身份)
核心理念： 将易经基础知识融入快速问答和识别挑战中，让玩家在碎片时间轻松学习。
主要功能：
快速、多样的易经知识小挑战（例如：认卦、辨爻变）。
严格的 1 分钟倒计时游戏回合。
每完成一个挑战后，提供简洁的易经知识点反馈。
实时积分累积。
游戏结束与分数提交。
排行榜展示。 
（可选/基于 Wagmi 实现）用户身份识别（钱包地址）及链上积分/排名存储。
2. 游戏设计

游戏流程：
开始游戏： 用户点击“开始”，1分钟计时器启动。
挑战循环 (持续 2 分钟)：
游戏随机呈现一个易经相关的“小挑战”。
玩家快速进行识别或选择答案。
根据玩家的准确度和速度（或仅准确度）获得积分。
即时反馈： 完成挑战后，游戏立刻显示正确答案，并提供一个非常简洁的易经知识点解释（例如：“此卦为乾为天，象征刚健有力”，“这条爻是老阳，会从阳变阴”）。
游戏立即切换到下一个小挑战。
时间耗尽： 1分钟计时结束，游戏强制结束。
分数结算： 显示本局累计总得分。
提交分数： 用户选择是否提交分数到排行榜。
查看排名： 用户可以查看所有玩家的排行榜。
时长控制： 游戏总时长固定为 1 分钟。挑战设计应简洁快速，让玩家在 1 分钟内能完成多个小挑战。
单人玩法： 所有游戏进程独立于其他玩家，只在分数提交后参与排名竞争。
学习融入：
将易经基础概念（卦名、爻的阴阳老少、变爻、之卦）转化为可快速识别和选择的题型。
每次答题后的即时反馈是关键的学习环节，解释要简短易懂。
挑战类型示例 (可在 1 分钟内快速完成)：
卦象识别： 显示一个卦象图形，从 3-4 个卦名选项中选出正确的一个。
爻变判断： 显示一条爻（线），判断它是“阳”、“阴”、“老阳”还是“老阴”。
变爻位置： 显示一个有变爻的卦象，指出（点击）变爻的位置。
之卦速辨： 显示一个有变爻的主卦，从 2-3 个选项中选出变化后的“之卦”。
上下卦识别： 显示一个卦象，分别识别其上卦和下卦的名称。
积分规则：
每正确完成一个小挑战获得固定积分。
可以根据挑战难度设置不同分值。
1 分钟结束后统计总积分。不考虑速度加成（避免玩家过于焦虑），专注于准确性和完成数量。
排行榜：
按单局最高总积分排名。
展示玩家昵称（或钱包地址的简化形式）和积分。
3. 技术架构

Mini App 平台层： 处理平台特有逻辑。
前端层 (Vite + React + TS)：
Vite 构建工具。
React 组件化界面开发。
TypeScript 静态类型检查。
核心模块： 游戏主界面、计时器、挑战区域（根据当前挑战类型动态渲染）、得分显示、反馈信息显示、排行榜界面。
链上交互层 (Wagmi)：
连接用户钱包，获取链上地址作为唯一玩家 ID。
（可选）与智能合约交互提交分数。
后端/存储层：
方案 A (中心化 - 推荐): 构建一个简单的后端服务和数据库，用于存储用户分数和提供排行榜数据 API。此方案开发速度快，管理简单。
方案 B (去中心化 - 结合 Wagmi): 智能合约存储分数。需要考虑链上存储成本、查询和排序的复杂性。可能仍需链下服务辅助构建排行榜数据。
文档侧重前端实现和与外部服务（API 或链上合约）交互的接口设计。
4. 开发环境搭建

同《易经速测挑战》开发文档 3. 开发环境搭建。
5. 模块详细设计 (React 组件 & 逻辑)

src/App.tsx: 应用入口，Wagmi Provider, 路由。
src/wagmi.ts: Wagmi 配置。
src/screens/GameScreen.tsx:
管理游戏状态 (idle, playing, finished)。
初始化并控制 1 分钟计时器。
根据计时器状态和游戏进度，生成并切换当前要显示的小挑战类型。
接收小挑战组件的完成事件和得分。
累计总得分。
控制游戏结束流程。
src/components/GameTimer.tsx: 同前。
src/components/ChallengeArea.tsx: 一个容器组件，根据 GameScreen 传递的当前挑战类型和数据，动态渲染对应的挑战组件（如 HexagramIdentifyChallenge 或 LineChangeChallenge）。
src/challenges/HexagramIdentifyChallenge.tsx:
接收卦象数据。
显示卦象图形。
显示多个卦名选项（包含一个正确答案）。
处理用户点击选择。
将选择结果和是否正确反馈给 GameScreen。
src/challenges/LineChangeChallenge.tsx:
接收卦象数据。
显示卦象图形。
可能需要用户点击变爻，或从选项中选择变爻位置，或选择之卦名称。
处理用户交互并将结果反馈给 GameScreen。
src/utils/iching.ts:
核心逻辑： 扩展包含：
随机生成卦象（可能需要控制生成带变爻卦的概率）。
根据卦象获取卦名、上下卦名。
判断爻的类型 (阴/阳/老阴/老阳)。
根据变爻生成之卦。
获取简洁的卦名、爻、变爻、之卦的学习解释文本。
生成挑战数据（卦象、正确答案、错误选项）。
src/components/FeedbackDisplay.tsx:
在完成每个小挑战后，短暂显示正确答案和对应的简短学习解释。
src/components/ScoreDisplay.tsx: 显示当前累计总得分。
src/screens/RankingScreen.tsx: 同前。
src/components/WalletConnectButton.tsx (如果使用 Wagmi): 同前。
src/api/scores.ts (中心化后端): 同前。
src/contracts/Scoreboard.sol (链上存储): 智能合约设计需要适应单局总分的存储和查询。
src/hooks/useScoreboard.ts (链上存储): 封装 Wagmi 调用。
6. 数据结构

爻 (Yao): { type: '阳' | '阴' | '老阳' | '老阴', value: 6 | 7 | 8 | 9 }
卦象 (Hexagram): Array<Yao> (长度为 6)
挑战数据 (ChallengeData): { type: 'identifyHexagram' | 'identifyLineChange' | ..., hexagramData: Hexagram, options: string[], correctAnswer: string, learningText: string, points: number }
游戏分数 (GameScore): { playerId: string, score: number, timestamp: number }
排行榜数据 (RankingData): Array<GameScore>
7. Wagmi 集成细节

同《易经速测挑战》开发文档 7. Wagmi 集成细节。主要用于获取玩家的链上地址作为排行榜 ID。链上存储分数需额外开发智能合约和链上交互逻辑。
8. 部署

同《易经速测挑战》开发文档 8. 部署。
9. 未来增强

增加更多类型的小挑战。
根据玩家表现调整挑战难度。
提供更系统的易经基础知识库供玩家查阅。
音效和视觉效果增强，提升游戏趣味性。
每日/每周挑战和奖励。
集成 Mini App 的用户体系，如果不需要链上身份的话。